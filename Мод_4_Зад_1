set search_path to lecture4_bogomolova;

/*Задание 1. Спроектируйте базу данных для следующих сущностей:
· язык (английский, французский и т. п.);
· народность (славяне, англосаксы и т. п.);
· страны (Россия, Германия и т. п.).

Правила следующие:
· на одном языке могут говорить несколько народностей;
· одна народность может проживать в нескольких странах;
· в каждой стране могут проживать нескольких народностей.

Таким образом должно получиться 5 таблиц: 3 таблицы-справочника и 2 таблицы со связями (пример таблицы со связями — film_actor).

Требования к таблицам-справочникам:
· идентификатор сущности должен присваиваться автоинкрементом;
· наименования сущностей не должны содержать null-значения, не должны допускаться дубликаты в названиях сущностей*/
create table "language" (
language_id serial primary key,
name varchar(50) unique not null,
last_update timestamp default now()
);--таблица-справочник языков

create table nation (
nation_id serial primary key,
name varchar(50) unique not null,
language_id int2 references language(language_id),
last_update timestamp default now()
);--таблица-справочник народностей

create table country (
country_id serial primary key,
country varchar(50) unique not null,
last_update timestamp default now()
);--таблица-справочник стран

create table nation_country (
country_id int2 not null references country(country_id),
nation_id int2 not null references nation(nation_id),
last_update timestamp default now(),
primary key (country_id,nation_id)
);--связная таблица стран и народностей

create table nation_language (
language_id int2 not null references language(language_id),
nation_id int2 not null references nation(nation_id),
last_update timestamp default now(),
primary key (language_id,nation_id)
);--связная таблица языков и народностей

insert into language (name)
values ('Русский'),
		('Английский'),
		('Турецкий'),
		('Немецкий'),
		('Китайский')
;--заполняем таблицу языков

insert into country (country)
values ('Россия'),
		('Великобритания'),
		('Турция'),
		('Германия'),
		('Китай')
;--заполняем таблицу стран

insert into nation (name,language_id)
values ('Славяне',1),
		('Англосаксы',2),
		('Тюрки',3),
		('Саксы',4),
		('Ханьцы',5),
		('Уйгуры',5);--внесена 6-я запись для демонстрации первого правила
--заполняем таблицу народностей

insert into nation_language (language_id,nation_id)
values ('1','1'),
		('2','2'),
		('3','3'),
		('4','4'),
		('5','5'),
		('5','6')
;--заполняем связную таблицу язык-народность

insert into nation_country (country_id,nation_id)
values ('1','1'),
		('2','2'),
		('3','3'),
		('4','4'),
		('5','5'),
		('5','6'),
		('4','3'),
		('4','1'),
		('2','1'),
		('1','5'),
		('3','1')
;--заполняем связную таблицу страна-народность